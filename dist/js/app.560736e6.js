(function(){"use strict";var e={444:function(e,t,n){var r=n(1930),l=n(8047);const s={id:"app"};function a(e,t,n,r,a,u){const i=(0,l.g2)("GameTable");return(0,l.uX)(),(0,l.CE)("div",s,[a.showGame?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("button",{key:0,onClick:t[0]||(t[0]=e=>a.showGame=!0)},"开始")),a.showGame?((0,l.uX)(),(0,l.Wv)(i,{key:1})):(0,l.Q3)("",!0)])}n(6040),n(9062);var u=n(934);const i={class:"game-table"},o={class:"recorder-top-bar"},c={class:"recorder-top-inner"},h={class:"players"},d={class:"table-center"},f={class:"current-play history-scroll"},v={key:0},g={style:{"font-weight":"bold"}},p={key:0},y={key:1,style:{color:"#aaa"}},m={key:1},k={class:"current-turn"},C={class:"bottom-bar"},b={key:0,class:"actions"},x=["disabled"],I={key:0,class:"winner-modal"},L={class:"winner-content"};function w(e,t,n,r,s,a){const w=(0,l.g2)("Recorder"),O=(0,l.g2)("AIBlock"),P=(0,l.g2)("CardHand");return(0,l.uX)(),(0,l.CE)("div",i,[(0,l.Lk)("div",o,[(0,l.Lk)("div",c,[(0,l.bF)(w,{players:s.players,cardOrder:s.cardOrder},null,8,["players","cardOrder"])])]),(0,l.Lk)("div",h,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.players.slice(1),(e,t)=>((0,l.uX)(),(0,l.Wv)(O,{key:t+1,name:e.name,hand:e.hand},null,8,["name","hand"]))),128))]),(0,l.Lk)("div",d,[(0,l.Lk)("div",f,[t[3]||(t[3]=(0,l.Lk)("div",null,"出牌记录：",-1)),s.historyPlays.length?((0,l.uX)(),(0,l.CE)("div",v,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.historyPlays,(e,t)=>((0,l.uX)(),(0,l.CE)("div",{key:t},[(0,l.Lk)("span",g,(0,u.v_)(e.name)+"：",1),e.cards.length?((0,l.uX)(),(0,l.CE)("span",p,(0,u.v_)(e.cards.map(e=>e.suit+e.value).join(" ")),1)):((0,l.uX)(),(0,l.CE)("span",y,"不要"))]))),128))])):((0,l.uX)(),(0,l.CE)("div",m,"无"))]),(0,l.Lk)("div",k,[t[4]||(t[4]=(0,l.eW)("当前轮到：")),(0,l.Lk)("span",{class:(0,u.C4)({me:0===s.currentTurn})},(0,u.v_)(s.players[s.currentTurn].name),3)])]),(0,l.Lk)("div",C,[(0,l.bF)(P,{hand:s.players[0].hand,selectedIndexes:s.selectedIndexes,getSuitClass:a.getSuitClass,onToggleSelect:a.toggleSelect},null,8,["hand","selectedIndexes","getSuitClass","onToggleSelect"]),0===s.currentTurn&&null===s.winner?((0,l.uX)(),(0,l.CE)("div",b,[(0,l.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>a.playCards&&a.playCards(...e)),disabled:0===s.selectedIndexes.length},"出牌",8,x),(0,l.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>a.pass&&a.pass(...e))},"不要")])):(0,l.Q3)("",!0)]),null!==s.winner?((0,l.uX)(),(0,l.CE)("div",I,[(0,l.Lk)("div",L,[(0,l.Lk)("div",null,"胜者："+(0,u.v_)(s.players[s.winner].name),1),(0,l.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>a.startGame&&a.startGame(...e))},"再来一局")])])):(0,l.Q3)("",!0)])}n(1201),n(2144),n(198);const O=["♠","♥","♣","♦"],P=["4","6","7","8","9","10","J","Q","K","A","2","3","5"];function T(){const e=[];for(const t of O)for(const n of P)e.push({suit:t,value:n});return e}function A(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}function E(e){const t=[[],[],[],[]];for(let n=0;n<e.length;n++)t[n%4].push(e[n]);for(let n=0;n<4;n++)t[n].sort((e,t)=>P.indexOf(e.value)-P.indexOf(t.value));return t}n(3047);function X(e,t){return P.indexOf(e.value)-P.indexOf(t.value)}function _(e,t){if(!e||0===e.length)return!1;const n=G(e);if("invalid"===n)return!1;if(!t||0===t.length)return!0;const r=G(t);if("bomb"===n&&"bomb"!==r)return!0;if("triple"===n&&"bomb"!==r&&"triple"!==r)return!0;if(n!==r)return!1;if(e.length!==t.length)return!1;const l=S(e),s=S(t);return X(l[0],s[0])>0}function S(e){return e.slice().sort(X)}function G(e){return 2===e.length&&e[0].value===e[1].value?"pair":3===e.length&&e[0].value===e[1].value&&e[1].value===e[2].value?"triple":4===e.length&&e[0].value===e[1].value&&e[1].value===e[2].value&&e[2].value===e[3].value?"bomb":j(e)?"straight":F(e)?"doubleStraight":1===e.length?"single":"invalid"}function j(e){if(e.length<3)return!1;const t=e.map(e=>P.indexOf(e.value)).sort((e,t)=>e-t);for(let n=1;n<t.length;n++)if(t[n]-t[n-1]!==1)return!1;return!0}function F(e){if(e.length<4||e.length%2!==0)return!1;const t=e.slice().sort(X);for(let n=0;n<t.length;n+=2){if(t[n].value!==t[n+1].value)return!1;if(n>0){const e=P.indexOf(t[n].value),r=P.indexOf(t[n-2].value);if(e-r!==1)return!1}}return!0}function K(e,t=[]){if(!e||0===e.length)return[];const n=S(e),r=J(n),l=r.filter(e=>4===e.length&&Q(e)),s=r.filter(e=>e.length>=5&&R(e)),a=r.filter(e=>e.length>=6&&V(e)),u=r.filter(e=>3===e.length&&W(e)),i=r.filter(e=>2===e.length&&H(e)),o=r.filter(e=>1===e.length);if(t&&t.length>0){if(W(t)){for(const e of u)if(_(e,t))return e;for(const e of l)if(_(e,t))return e;return[]}if(Q(t)){for(const e of l)if(_(e,t))return e;return[]}for(const e of r)if(!Q(e)&&!W(e)&&_(e,t)&&!M(e,n,l,s,a,u))return e;for(const e of r)if(_(e,t))return e;return[]}return s.length>0?s[0]:a.length>0?a[0]:u.length>0?u[0]:i.length>0?i[0]:o.length>0?o[0]:l.length>0?l[0]:[n[0]]}function Q(e){return 4===e.length&&e.every(t=>t.value===e[0].value)}function W(e){return 3===e.length&&e.every(t=>t.value===e[0].value)}function H(e){return 2===e.length&&e[0].value===e[1].value}function M(e,t,n,r,l,s){for(const a of n)if(a.some(t=>e.includes(t))&&!B(a,e))return!0;for(const a of r)if(a.some(t=>e.includes(t))&&!B(a,e))return!0;for(const a of l)if(a.some(t=>e.includes(t))&&!B(a,e))return!0;for(const a of s)if(a.some(t=>e.includes(t))&&!B(a,e))return!0;return!1}function B(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function J(e){const t=[];for(let n=0;n<e.length;n++)t.push([e[n]]);for(let n=0;n<e.length-1;n++)e[n].value===e[n+1].value&&t.push([e[n],e[n+1]]);for(let n=0;n<e.length-2;n++)e[n].value===e[n+1].value&&e[n].value===e[n+2].value&&t.push([e[n],e[n+1],e[n+2]]);for(let n=0;n<e.length-3;n++)e[n].value===e[n+1].value&&e[n].value===e[n+2].value&&e[n].value===e[n+3].value&&t.push([e[n],e[n+1],e[n+2],e[n+3]]);for(let n=3;n<=e.length;n++)for(let r=0;r<=e.length-n;r++){const l=e.slice(r,r+n);R(l)&&t.push(l)}for(let n=4;n<=e.length;n+=2)for(let r=0;r<=e.length-n;r++){const l=e.slice(r,r+n);V(l)&&t.push(l)}return t.sort((e,t)=>e.length-t.length||e[0].value.localeCompare(t[0].value)),t}function R(e){if(e.length<3)return!1;for(let t=1;t<e.length;t++){if(e[t].value===e[t-1].value)return!1;if(e[t].value.charCodeAt(0)-e[t-1].value.charCodeAt(0)!==1)return!1}return!0}function V(e){if(e.length<4||e.length%2!==0)return!1;for(let t=0;t<e.length;t+=2){if(e[t].value!==e[t+1].value)return!1;if(t>0&&e[t].value.charCodeAt(0)-e[t-2].value.charCodeAt(0)!==1)return!1}return!0}const $={class:"hand",ref:"myHand"},q=["onClick"];function z(e,t,n,r,s,a){return(0,l.uX)(),(0,l.CE)("div",$,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(n.hand,(e,t)=>((0,l.uX)(),(0,l.CE)("span",{key:t,class:(0,u.C4)([{selected:n.selectedIndexes.includes(t)},n.getSuitClass(e.suit),"card-item"]),onClick:e=>a.toggleSelect(t)},[(0,l.Lk)("span",{class:(0,u.C4)(["suit-symbol",n.getSuitClass(e.suit)])},(0,u.v_)(e.suit),3),(0,l.Lk)("span",{class:(0,u.C4)(n.getSuitClass(e.suit))},(0,u.v_)(e.value),3)],10,q))),128))],512)}var D={name:"CardHand",props:{hand:Array,selectedIndexes:Array,getSuitClass:Function},emits:["toggleSelect"],methods:{toggleSelect(e){this.$emit("toggleSelect",e)}}},N=n(7017);const U=(0,N.A)(D,[["render",z],["__scopeId","data-v-7455e1cc"]]);var Y=U;const Z={class:"recorder"},ee={class:"recorder-cards"},te={class:"recorder-row"},ne={class:"recorder-row"};function re(e,t,n,r,s,a){return(0,l.uX)(),(0,l.CE)("div",Z,[t[0]||(t[0]=(0,l.Lk)("div",{class:"recorder-title"},"记牌器",-1)),(0,l.Lk)("div",ee,[(0,l.Lk)("div",te,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(n.cardOrder,e=>((0,l.uX)(),(0,l.CE)("span",{key:e,class:"recorder-num"},(0,u.v_)(e),1))),128))]),(0,l.Lk)("div",ne,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(n.cardOrder,e=>((0,l.uX)(),(0,l.CE)("span",{key:e,class:"recorder-count"},(0,u.v_)(a.getCardLeftCount(n.players,e)),1))),128))])])])}const le=["4","6","7","8","9","10","J","Q","K","A","2","3","5"];function se(e,t){let n=0;for(let r=1;r<e.length;r++)n+=e[r].hand.filter(e=>e.value===t).length;return n}var ae={name:"Recorder",props:{players:Array,cardOrder:{type:Array,default:()=>le}},methods:{getCardLeftCount:se}};const ue=(0,N.A)(ae,[["render",re],["__scopeId","data-v-40ea67fe"]]);var ie=ue;const oe={class:"ai-block"},ce={class:"ai-title"},he={class:"hand ai-hand"};function de(e,t,n,r,s,a){return(0,l.uX)(),(0,l.CE)("div",oe,[(0,l.Lk)("div",ce,(0,u.v_)(n.name),1),(0,l.Lk)("div",he,"剩余："+(0,u.v_)(n.hand.length)+" 张",1)])}var fe={name:"AIBlock",props:{name:String,hand:Array}};const ve=(0,N.A)(fe,[["render",de],["__scopeId","data-v-736fe371"]]);var ge=ve,pe={name:"GameTable",components:{CardHand:Y,Recorder:ie,AIBlock:ge},data(){return{players:[{name:"我",hand:[]},{name:"AI1",hand:[]},{name:"AI2",hand:[]},{name:"AI3",hand:[]}],cardOrder:["4","6","7","8","9","10","J","Q","K","A","2","3","5"],currentTurn:0,currentPlay:[],winner:null,selectedIndexes:[],historyPlays:[]}},computed:{canPlay(){return 0===this.currentTurn&&this.players[0].hand.length>0&&null===this.winner},canPass(){return 0===this.currentTurn&&null===this.winner}},methods:{startGame(){const e=A(T()),t=E(e);for(let n=0;n<4;n++)this.players[n].hand=t[n];this.currentTurn=0,this.currentPlay=[],this.historyPlays=[],this.winner=null,this.selectedIndexes=[]},getLastValidPlay(){for(let e=this.historyPlays.length-1;e>=0;e--)if(this.historyPlays[e].cards&&this.historyPlays[e].cards.length>0)return this.historyPlays[e];return null},playCards(){if(0===this.selectedIndexes.length)return;const e=this.selectedIndexes.slice().sort((e,t)=>e-t),t=e.map(e=>this.players[0].hand[e]),n=this.getLastValidPlay();let r=[];if(n&&n.name!==this.players[0].name&&(r=n.cards),_(t,r)){this.currentPlay=t,this.historyPlays.push({name:this.players[0].name,cards:t.map(e=>({...e}))});for(let t=e.length-1;t>=0;t--)this.players[0].hand.splice(e[t],1);this.selectedIndexes=[],this.checkWinner(),this.nextTurn()}else alert("手牌小")},getSuitClass(e){return"♥"===e||"♦"===e?"red-suit":"♠"===e?"black-suit":"♣"===e?"club-suit":""},toggleSelect(e){if(0!==this.currentTurn||null!==this.winner)return;const t=this.selectedIndexes.indexOf(e);this.selectedIndexes=-1===t?[...this.selectedIndexes,e]:this.selectedIndexes.filter(t=>t!==e)},pass(){this.nextTurn()},nextTurn(){null===this.winner&&(this.currentTurn=(this.currentTurn+1)%4,0!==this.currentTurn&&this.aiPlay())},aiPlay(){const e=this.players[this.currentTurn];e.hand.length>0?setTimeout(()=>{const t=this.getLastValidPlay();let n=[];t&&t.name!==e.name&&(n=t.cards);const r=K(e.hand,n);r&&r.length>0?(this.currentPlay=r,this.historyPlays.push({name:e.name,cards:r.map(e=>({...e}))}),e.hand=e.hand.filter(e=>!r.some(t=>t.suit===e.suit&&t.value===e.value))):(this.historyPlays.push({name:e.name,cards:[]}),this.currentPlay=[]),this.checkWinner(),this.nextTurn()},700+800*Math.random()):(this.currentPlay=[],this.checkWinner(),this.nextTurn())},checkWinner(){for(let e=0;e<4;e++)0===this.players[e].hand.length&&(this.winner=e)}},mounted(){this.startGame()}};const ye=(0,N.A)(pe,[["render",w],["__scopeId","data-v-62e302e7"]]);var me=ye,ke={name:"App",components:{GameTable:me},data(){return{showGame:!1}}};const Ce=(0,N.A)(ke,[["render",a]]);var be=Ce;(0,r.Ef)(be).mount("#app")}},t={};function n(r){var l=t[r];if(void 0!==l)return l.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}n.m=e,function(){var e=[];n.O=function(t,r,l,s){if(!r){var a=1/0;for(c=0;c<e.length;c++){r=e[c][0],l=e[c][1],s=e[c][2];for(var u=!0,i=0;i<r.length;i++)(!1&s||a>=s)&&Object.keys(n.O).every(function(e){return n.O[e](r[i])})?r.splice(i--,1):(u=!1,s<a&&(a=s));if(u){e.splice(c--,1);var o=l();void 0!==o&&(t=o)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[r,l,s]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,r){var l,s,a=r[0],u=r[1],i=r[2],o=0;if(a.some(function(t){return 0!==e[t]})){for(l in u)n.o(u,l)&&(n.m[l]=u[l]);if(i)var c=i(n)}for(t&&t(r);o<a.length;o++)s=a[o],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(c)},r=self["webpackChunkjihei5"]=self["webpackChunkjihei5"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=n.O(void 0,[504],function(){return n(444)});r=n.O(r)})();
//# sourceMappingURL=app.560736e6.js.map