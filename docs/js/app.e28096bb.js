(function(){"use strict";var e={38:function(e,t,n){var r=n(1930),s=n(8047);const a={id:"app"};function l(e,t,n,r,l,i){const u=(0,s.g2)("GameTable");return(0,s.uX)(),(0,s.CE)("div",a,[l.showGame?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[0]||(t[0]=e=>l.showGame=!0)},"开始")),l.showGame?((0,s.uX)(),(0,s.Wv)(u,{key:1})):(0,s.Q3)("",!0)])}var i=n(934);const u={class:"game-table"},o={class:"top-container"},c={class:"recorder-top-bar"},h={class:"recorder-top-inner"},d={class:"ai-row-on-top"},f={class:"ai-block-wrap"},v={class:"player-label"},p={class:"player-hand-count"},g={class:"table-center"},y={class:"current-play history-scroll",ref:"historyScroll"},m={key:0,ref:"historyList",class:"history-list"},k={class:"history-name"},C={key:0,class:"history-cards"},L={class:"card-corner top-left"},b={class:"card-corner bottom-right"},x={key:1,class:"history-pass"},I={key:1},P={class:"fixed-play-info"},T={class:"current-play-area"},S={class:"play-area-cards"},w={class:"card-corner top-left"},A={class:"card-corner bottom-right"},E={key:1,class:"play-pass"},O={class:"bottom-bar"},X={class:"actions"},_=["disabled"],F=["disabled"],G={key:0,class:"winner-modal"},K={class:"winner-content"};function j(e,t,n,r,a,l){const j=(0,s.g2)("Recorder"),W=(0,s.g2)("CardHand");return(0,s.uX)(),(0,s.CE)("div",u,[(0,s.Lk)("div",o,[(0,s.Lk)("div",c,[(0,s.Lk)("div",h,[(0,s.bF)(j,{players:a.players,cardOrder:a.cardOrder},null,8,["players","cardOrder"])])]),(0,s.Lk)("div",d,[(0,s.Lk)("div",f,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.players,(e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:(0,i.C4)(["player-tab",{active:a.currentTurn===t,me:0===t}])},[(0,s.Lk)("span",v,(0,i.v_)(0===t?"我":e.name),1),(0,s.Lk)("span",p,"剩余："+(0,i.v_)(e.hand.length)+" 张",1)],2))),128))])])]),(0,s.Lk)("div",g,[(0,s.Lk)("div",y,[t[3]||(t[3]=(0,s.Lk)("div",null,"出牌记录：",-1)),a.historyPlays.length?((0,s.uX)(),(0,s.CE)("div",m,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.historyPlays,(e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:"history-item"},[(0,s.Lk)("span",k,(0,i.v_)(e.name)+"：",1),e.cards.length?((0,s.uX)(),(0,s.CE)("span",C,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.cards,(e,t)=>((0,s.uX)(),(0,s.CE)("span",{key:t,class:(0,i.C4)(["card-item",l.getSuitClass(e.suit)])},[(0,s.Lk)("span",L,[(0,s.Lk)("span",{class:(0,i.C4)(["corner-value",l.getSuitClass(e.suit)])},(0,i.v_)(e.value),3),(0,s.Lk)("span",{class:(0,i.C4)(["corner-suit",l.getSuitClass(e.suit)])},(0,i.v_)(e.suit),3)]),(0,s.Lk)("span",b,[(0,s.Lk)("span",{class:(0,i.C4)(["corner-value",l.getSuitClass(e.suit)])},(0,i.v_)(e.value),3),(0,s.Lk)("span",{class:(0,i.C4)(["corner-suit",l.getSuitClass(e.suit)])},(0,i.v_)(e.suit),3)])],2))),128))])):((0,s.uX)(),(0,s.CE)("span",x,"不要"))]))),128))],512)):((0,s.uX)(),(0,s.CE)("div",I,"无"))],512)]),(0,s.Lk)("div",P,[(0,s.Lk)("div",T,[t[4]||(t[4]=(0,s.Lk)("div",{class:"play-area-label"},"当前出牌：",-1)),(0,s.Lk)("div",S,[a.currentPlay&&a.currentPlay.length?((0,s.uX)(!0),(0,s.CE)(s.FK,{key:0},(0,s.pI)(a.currentPlay,(e,t)=>((0,s.uX)(),(0,s.CE)("span",{key:t,class:(0,i.C4)(["card-item",l.getSuitClass(e.suit)])},[(0,s.Lk)("span",w,[(0,s.Lk)("span",{class:(0,i.C4)(["corner-value",l.getSuitClass(e.suit)])},(0,i.v_)(e.value),3),(0,s.Lk)("span",{class:(0,i.C4)(["corner-suit",l.getSuitClass(e.suit)])},(0,i.v_)(e.suit),3)]),(0,s.Lk)("span",A,[(0,s.Lk)("span",{class:(0,i.C4)(["corner-value",l.getSuitClass(e.suit)])},(0,i.v_)(e.value),3),(0,s.Lk)("span",{class:(0,i.C4)(["corner-suit",l.getSuitClass(e.suit)])},(0,i.v_)(e.suit),3)])],2))),128)):((0,s.uX)(),(0,s.CE)("span",E,"不要"))])])]),(0,s.Lk)("div",O,[(0,s.Lk)("div",X,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>l.playCards&&l.playCards(...e)),disabled:l.canPlay},"出牌",8,_),(0,s.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>l.pass&&l.pass(...e)),disabled:l.canPass},"不要",8,F)]),(0,s.bF)(W,{hand:a.players[this.currentTurn].hand,selectedIndexes:a.selectedIndexes,getSuitClass:l.getSuitClass,onToggleSelect:l.toggleSelect},null,8,["hand","selectedIndexes","getSuitClass","onToggleSelect"])]),null!==a.winner?((0,s.uX)(),(0,s.CE)("div",G,[(0,s.Lk)("div",K,[(0,s.Lk)("div",null,"胜者："+(0,i.v_)(a.players[a.winner].name),1),(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>l.startGame&&l.startGame(...e))},"再来一局")])])):(0,s.Q3)("",!0)])}n(1201),n(6040),n(2144),n(9062),n(198);const W=["♠","♥","♣","♦"],B=["4","6","7","8","9","10","J","Q","K","A","2","3","5"];function H(){const e=[];for(const t of W)for(const n of B)e.push({suit:t,value:n});return e}function Q(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}function M(e){const t=[[],[],[],[]];for(let n=0;n<e.length;n++)t[n%4].push(e[n]);for(let n=0;n<4;n++)t[n].sort((e,t)=>B.indexOf(e.value)-B.indexOf(t.value));return t}n(3047);function J(e,t){return B.indexOf(e.value)-B.indexOf(t.value)}function R(e,t){if(!e||0===e.length)return!1;const n=$(e);if("invalid"===n)return!1;if(!t||0===t.length)return!0;const r=$(t);if("bomb"===n&&"bomb"!==r)return!0;if("triple"===n&&"bomb"!==r&&"triple"!==r)return!0;if(n!==r)return!1;if(e.length!==t.length)return!1;const s=V(e),a=V(t);return J(s[0],a[0])>0}function V(e){return e.slice().sort(J)}function $(e){return 2===e.length&&e[0].value===e[1].value?"pair":3===e.length&&e[0].value===e[1].value&&e[1].value===e[2].value?"triple":4===e.length&&e[0].value===e[1].value&&e[1].value===e[2].value&&e[2].value===e[3].value?"bomb":q(e)?"straight":z(e)?"doubleStraight":1===e.length?"single":"invalid"}function q(e){if(e.length<3)return!1;const t=e.map(e=>B.indexOf(e.value)).sort((e,t)=>e-t);for(let n=1;n<t.length;n++)if(t[n]-t[n-1]!==1)return!1;return!0}function z(e){if(e.length<4||e.length%2!==0)return!1;const t=e.slice().sort(J);for(let n=0;n<t.length;n+=2){if(t[n].value!==t[n+1].value)return!1;if(n>0){const e=B.indexOf(t[n].value),r=B.indexOf(t[n-2].value);if(e-r!==1)return!1}}return!0}function D(e,t=[]){if(!e||0===e.length)return[];const n=V(e),r=te(n),s=r.filter(e=>3===e.length&&U(e)),a=r.filter(e=>4===e.length&&N(e)),l=r.filter(e=>e.length>=3&&ne(e)),i=r.filter(e=>e.length>=4&&re(e)),u=r.filter(e=>2===e.length&&Y(e)),o=r.filter(e=>1===e.length);if(t&&t.length>0){if(U(t)){for(const e of s)if(R(e,t))return e;for(const e of a)if(R(e,t))return e;return[]}if(N(t)){for(const e of a)if(R(e,t))return e;return[]}for(const e of r)if(!N(e)&&!U(e)&&R(e,t)&&!Z(e,n,a,l,i,s)&&(1===e.length||2===e.length))return e;for(const e of r)if(!N(e)&&R(e,t)&&!Z(e,n,a,l,i,s))return e;for(const e of r)if(R(e,t))return e;return[]}return e.length>5?l.length>0?l[0]:i.length>0?i[0]:s.length>0?s[0]:u.length>0?u[0]:o.length>0?o[0]:a.length>0?a[0]:[n[0]]:o.length>0?o[0]:u.length>0?u[0]:s.length>0?s[0]:l.length>0?l[0]:i.length>0?i[0]:a.length>0?a[0]:[n[0]]}function N(e){return 4===e.length&&e.every(t=>t.value===e[0].value)}function U(e){return 3===e.length&&e.every(t=>t.value===e[0].value)}function Y(e){return 2===e.length&&e[0].value===e[1].value}function Z(e,t,n,r,s,a){for(const l of n)if(l.some(t=>e.includes(t))&&!ee(l,e))return!0;for(const l of r)if(l.some(t=>e.includes(t))&&!ee(l,e))return!0;for(const l of s)if(l.some(t=>e.includes(t))&&!ee(l,e))return!0;for(const l of a)if(l.some(t=>e.includes(t))&&!ee(l,e))return!0;return!1}function ee(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function te(e){const t=[];for(let n=0;n<e.length;n++)t.push([e[n]]);for(let n=0;n<e.length-1;n++)e[n].value===e[n+1].value&&t.push([e[n],e[n+1]]);for(let n=0;n<e.length-2;n++)e[n].value===e[n+1].value&&e[n].value===e[n+2].value&&t.push([e[n],e[n+1],e[n+2]]);for(let n=0;n<e.length-3;n++)e[n].value===e[n+1].value&&e[n].value===e[n+2].value&&e[n].value===e[n+3].value&&t.push([e[n],e[n+1],e[n+2],e[n+3]]);for(let n=3;n<=e.length;n++)for(let r=0;r<=e.length-n;r++){const s=e.slice(r,r+n);ne(s)&&t.push(s)}for(let n=4;n<=e.length;n+=2)for(let r=0;r<=e.length-n;r++){const s=e.slice(r,r+n);re(s)&&t.push(s)}return t.sort((e,t)=>e.length-t.length||e[0].value.localeCompare(t[0].value)),t}function ne(e){if(e.length<3)return!1;for(let t=1;t<e.length;t++){if(e[t].value===e[t-1].value)return!1;if(e[t].value.charCodeAt(0)-e[t-1].value.charCodeAt(0)!==1)return!1}return!0}function re(e){if(e.length<4||e.length%2!==0)return!1;for(let t=0;t<e.length;t+=2){if(e[t].value!==e[t+1].value)return!1;if(t>0&&e[t].value.charCodeAt(0)-e[t-2].value.charCodeAt(0)!==1)return!1}return!0}const se={class:"hand-outer"},ae=["onClick"],le={class:"card-corner top-left"},ie={class:"card-corner bottom-right"};function ue(e,t,n,r,a,l){return(0,s.uX)(),(0,s.CE)("div",se,[(0,s.Lk)("div",{class:"hand",ref:"myHand",style:(0,i.Tr)({width:l.handWidth+"px"})},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.hand,(e,t)=>((0,s.uX)(),(0,s.CE)("span",{key:t,class:(0,i.C4)([{selected:n.selectedIndexes.includes(t)},n.getSuitClass(e.suit),"card-item"]),onClick:e=>l.toggleSelect(t),style:(0,i.Tr)({left:22*t+"px",zIndex:t})},[(0,s.Lk)("span",le,[(0,s.Lk)("span",{class:(0,i.C4)(["corner-value",n.getSuitClass(e.suit)])},(0,i.v_)(e.value),3),(0,s.Lk)("span",{class:(0,i.C4)(["corner-suit",n.getSuitClass(e.suit)])},(0,i.v_)(e.suit),3)]),(0,s.Lk)("span",ie,[(0,s.Lk)("span",{class:(0,i.C4)(["corner-value",n.getSuitClass(e.suit)])},(0,i.v_)(e.value),3),(0,s.Lk)("span",{class:(0,i.C4)(["corner-suit",n.getSuitClass(e.suit)])},(0,i.v_)(e.suit),3)])],14,ae))),128))],4)])}var oe={name:"CardHand",props:{hand:Array,selectedIndexes:Array,getSuitClass:Function},emits:["toggleSelect"],computed:{handWidth(){return this.hand&&0!==this.hand.length?1===this.hand.length?44:44+22*(this.hand.length-1):0}},methods:{toggleSelect(e){this.$emit("toggleSelect",e)}}},ce=n(7017);const he=(0,ce.A)(oe,[["render",ue],["__scopeId","data-v-65454eae"]]);var de=he;const fe={class:"recorder"},ve={class:"recorder-cards"},pe={class:"recorder-row"},ge={class:"recorder-row"};function ye(e,t,n,r,a,l){return(0,s.uX)(),(0,s.CE)("div",fe,[t[0]||(t[0]=(0,s.Lk)("div",{class:"recorder-title"},"记牌器",-1)),(0,s.Lk)("div",ve,[(0,s.Lk)("div",pe,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.cardOrder,e=>((0,s.uX)(),(0,s.CE)("span",{key:e,class:"recorder-num"},(0,i.v_)(e),1))),128))]),(0,s.Lk)("div",ge,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.cardOrder,e=>((0,s.uX)(),(0,s.CE)("span",{key:e,class:"recorder-count"},(0,i.v_)(l.getCardLeftCount(n.players,e)),1))),128))])])])}const me=["4","6","7","8","9","10","J","Q","K","A","2","3","5"];function ke(e,t){let n=0;for(let r=1;r<e.length;r++)n+=e[r].hand.filter(e=>e.value===t).length;return n}var Ce={name:"Recorder",props:{players:Array,cardOrder:{type:Array,default:()=>me}},methods:{getCardLeftCount:ke}};const Le=(0,ce.A)(Ce,[["render",ye],["__scopeId","data-v-40ea67fe"]]);var be=Le,xe={name:"GameTable",components:{CardHand:de,Recorder:be},created(){this.players=[{name:"自己",isAI:!1,isBanker:!0,team:0,hand:[]},{name:"AI1",isAI:!0,isBanker:!1,team:1,hand:[]},{name:"AI2",isAI:!0,isBanker:!1,team:1,hand:[]},{name:"AI3",isAI:!0,isBanker:!1,team:1,hand:[]}]},data(){return{players:[],cardOrder:["4","6","7","8","9","10","J","Q","K","A","2","3","5"],currentTurn:0,currentPlay:[],winner:null,selectedIndexes:[],historyPlays:[]}},watch:{historyPlays:{handler(){this.$nextTick(()=>{const e=this.$refs.historyList;e&&requestAnimationFrame(()=>{e.scrollTop=e.scrollHeight,requestAnimationFrame(()=>{e.scrollTop=e.scrollHeight})})})},deep:!0}},computed:{canPlay(){return this.players[this.currentTurn].isAI||null!==this.winner||0===this.selectedIndexes.length},canPass(){return this.players[this.currentTurn].isAI||null!==this.winner||0===this.historyPlays.length}},methods:{startGame(){const e=Q(H()),t=M(e);for(let n=0;n<4;n++)this.players[n].hand=t[n],this.hasBlackFive(this.players[n]);this.currentTurn=0,this.currentPlay=[],this.historyPlays=[],this.winner=null,this.selectedIndexes=[]},getLastValidPlay(){for(let e=this.historyPlays.length-1;e>=0;e--)if(this.historyPlays[e].cards&&this.historyPlays[e].cards.length>0)return this.historyPlays[e];return null},hasBlackFive(e){for(let t=0;t<e.hand.length;t++)if("♥"===e.hand[t].suit&&"5"===e.hand[t].value)return void(e.team=0)},playCards(){const e=this.players[this.currentTurn];if(0===this.selectedIndexes.length)return;const t=this.selectedIndexes.slice().sort((e,t)=>e-t),n=t.map(t=>e.hand[t]),r=this.getLastValidPlay();let s=[];if(r&&r.name!==e.name&&(s=r.cards),R(n,s)){this.currentPlay=n,this.historyPlays.push({name:e.name,cards:n.map(e=>({...e}))});for(let n=t.length-1;n>=0;n--)e.hand.splice(t[n],1);this.selectedIndexes=[],this.checkWinner(),this.nextTurn()}else alert("手牌小")},getSuitClass(e){return"♥"===e||"♦"===e?"red-suit":"♠"===e||"♣"===e?"black-suit":""},toggleSelect(e){if(0!==this.currentTurn||null!==this.winner)return;const t=this.selectedIndexes.indexOf(e);this.selectedIndexes=-1===t?[...this.selectedIndexes,e]:this.selectedIndexes.filter(t=>t!==e)},pass(){0===this.historyPlays.length&&alert("第一次不允许不出");const e=this.players[this.currentTurn];this.historyPlays.push({name:e.name,cards:[]}),this.currentPlay=[],this.nextTurn()},nextTurn(){if(null!==this.winner)return;this.currentTurn=(this.currentTurn+1)%4;const e=this.players[this.currentTurn];e.isAI&&this.aiPlay()},aiPlay(){const e=this.players[this.currentTurn];e.hand.length>0?setTimeout(()=>{const t=this.getLastValidPlay();let n=[];t&&t.name!==e.name&&(n=t.cards);const r=D(e.hand,n);r&&r.length>0?(this.currentPlay=r,this.historyPlays.push({name:e.name,cards:r.map(e=>({...e}))}),e.hand=e.hand.filter(e=>!r.some(t=>t.suit===e.suit&&t.value===e.value))):(this.historyPlays.push({name:e.name,cards:[]}),this.currentPlay=[]),this.checkWinner(),this.nextTurn()},700+800*Math.random()):(this.currentPlay=[],this.checkWinner(),this.nextTurn())},checkWinner(){for(let e=0;e<4;e++)0===this.players[e].hand.length&&(this.winner=e)}},mounted(){this.startGame()}};const Ie=(0,ce.A)(xe,[["render",j],["__scopeId","data-v-124b0136"]]);var Pe=Ie,Te={name:"App",components:{GameTable:Pe},data(){return{showGame:!1}}};const Se=(0,ce.A)(Te,[["render",l]]);var we=Se;(0,r.Ef)(we).mount("#app")}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}n.m=e,function(){var e=[];n.O=function(t,r,s,a){if(!r){var l=1/0;for(c=0;c<e.length;c++){r=e[c][0],s=e[c][1],a=e[c][2];for(var i=!0,u=0;u<r.length;u++)(!1&a||l>=a)&&Object.keys(n.O).every(function(e){return n.O[e](r[u])})?r.splice(u--,1):(i=!1,a<l&&(l=a));if(i){e.splice(c--,1);var o=s();void 0!==o&&(t=o)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[r,s,a]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,r){var s,a,l=r[0],i=r[1],u=r[2],o=0;if(l.some(function(t){return 0!==e[t]})){for(s in i)n.o(i,s)&&(n.m[s]=i[s]);if(u)var c=u(n)}for(t&&t(r);o<l.length;o++)a=l[o],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(c)},r=self["webpackChunkjihei5"]=self["webpackChunkjihei5"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=n.O(void 0,[504],function(){return n(38)});r=n.O(r)})();
//# sourceMappingURL=app.e28096bb.js.map