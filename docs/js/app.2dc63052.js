(function(){"use strict";var e={918:function(e,t,n){var r=n(1930),s=n(8047);const l={id:"app"};function a(e,t,n,r,a,i){const u=(0,s.g2)("GameTable");return(0,s.uX)(),(0,s.CE)("div",l,[a.showGame?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[0]||(t[0]=e=>a.showGame=!0)},"开始")),a.showGame?((0,s.uX)(),(0,s.Wv)(u,{key:1})):(0,s.Q3)("",!0)])}var i=n(934);const u={class:"game-table"},o={class:"top-container"},c={class:"recorder-top-bar"},h={class:"recorder-top-inner"},d={class:"ai-row-on-top"},f={class:"ai-block-wrap"},v=["onClick"],g={class:"player-label"},p={class:"player-hand-count"},y={class:"table-center"},m={class:"current-play history-scroll",ref:"historyScroll"},k={key:0,ref:"historyList",class:"history-list"},C={class:"history-name"},b={key:0,class:"history-cards"},x={class:"card-corner top-left"},L={class:"card-corner bottom-right"},A={key:1,class:"history-pass"},I={key:1},$={class:"fixed-play-info"},E={class:"current-play-area"},S={class:"play-area-cards"},P={class:"card-corner top-left"},w={class:"card-corner bottom-right"},O={key:1,class:"play-pass"},T={class:"bottom-bar"},X={class:"actions"},_=["disabled"],H=["disabled"],K={key:0,class:"winner-modal"},F={class:"winner-content"};function G(e,t,n,r,l,a){const G=(0,s.g2)("Recorder"),B=(0,s.g2)("CardHand");return(0,s.uX)(),(0,s.CE)("div",u,[(0,s.Lk)("div",o,[(0,s.Lk)("div",c,[(0,s.Lk)("div",h,[(0,s.bF)(G,{players:l.players,cardOrder:l.cardOrder},null,8,["players","cardOrder"])])]),(0,s.Lk)("div",d,[(0,s.Lk)("div",f,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.players,(e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:(0,i.C4)(["player-tab",{active:l.currentTurn===t,me:0===t}]),onClick:e=>a.toggleHand(t)},[(0,s.Lk)("span",g,(0,i.v_)(0===t?"我":e.name),1),(0,s.Lk)("span",p,"剩余："+(0,i.v_)(e.hand.length)+" 张",1)],10,v))),128))])])]),(0,s.Lk)("div",y,[(0,s.Lk)("div",m,[t[3]||(t[3]=(0,s.Lk)("div",null,"出牌记录：",-1)),l.historyPlays.length?((0,s.uX)(),(0,s.CE)("div",k,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.historyPlays,(e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:"history-item"},[(0,s.Lk)("span",C,(0,i.v_)(e.name)+"：",1),e.cards.length?((0,s.uX)(),(0,s.CE)("span",b,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.cards,(e,t)=>((0,s.uX)(),(0,s.CE)("span",{key:t,class:(0,i.C4)(["card-item",a.getSuitClass(e.suit)])},[(0,s.Lk)("span",x,[(0,s.Lk)("span",{class:(0,i.C4)(["corner-value",a.getSuitClass(e.suit)])},(0,i.v_)(e.value),3),(0,s.Lk)("span",{class:(0,i.C4)(["corner-suit",a.getSuitClass(e.suit)])},(0,i.v_)(e.suit),3)]),(0,s.Lk)("span",L,[(0,s.Lk)("span",{class:(0,i.C4)(["corner-value",a.getSuitClass(e.suit)])},(0,i.v_)(e.value),3),(0,s.Lk)("span",{class:(0,i.C4)(["corner-suit",a.getSuitClass(e.suit)])},(0,i.v_)(e.suit),3)])],2))),128))])):((0,s.uX)(),(0,s.CE)("span",A,"不要"))]))),128))],512)):((0,s.uX)(),(0,s.CE)("div",I,"无"))],512)]),(0,s.Lk)("div",$,[(0,s.Lk)("div",E,[t[4]||(t[4]=(0,s.Lk)("div",{class:"play-area-label"},"当前出牌：",-1)),(0,s.Lk)("div",S,[l.currentPlay&&l.currentPlay.length?((0,s.uX)(!0),(0,s.CE)(s.FK,{key:0},(0,s.pI)(l.currentPlay,(e,t)=>((0,s.uX)(),(0,s.CE)("span",{key:t,class:(0,i.C4)(["card-item",a.getSuitClass(e.suit)])},[(0,s.Lk)("span",P,[(0,s.Lk)("span",{class:(0,i.C4)(["corner-value",a.getSuitClass(e.suit)])},(0,i.v_)(e.value),3),(0,s.Lk)("span",{class:(0,i.C4)(["corner-suit",a.getSuitClass(e.suit)])},(0,i.v_)(e.suit),3)]),(0,s.Lk)("span",w,[(0,s.Lk)("span",{class:(0,i.C4)(["corner-value",a.getSuitClass(e.suit)])},(0,i.v_)(e.value),3),(0,s.Lk)("span",{class:(0,i.C4)(["corner-suit",a.getSuitClass(e.suit)])},(0,i.v_)(e.suit),3)])],2))),128)):((0,s.uX)(),(0,s.CE)("span",O,"不要"))])])]),(0,s.Lk)("div",T,[(0,s.Lk)("div",X,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>a.playCards&&a.playCards(...e)),disabled:a.canPlay},"出牌",8,_),(0,s.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>a.pass&&a.pass(...e)),disabled:a.canPass},"不要",8,H)]),(0,s.bF)(B,{hand:l.players[0].hand,selectedIndexes:l.selectedIndexes,getSuitClass:a.getSuitClass,onToggleSelect:a.toggleSelect},null,8,["hand","selectedIndexes","getSuitClass","onToggleSelect"])]),null!==l.winner?((0,s.uX)(),(0,s.CE)("div",K,[(0,s.Lk)("div",F,[(0,s.Lk)("div",null,"胜者："+(0,i.v_)(l.players[l.winner].name),1),(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>a.startGame&&a.startGame(...e))},"再来一局")])])):(0,s.Q3)("",!0),null!==l.hoverHandIdx?((0,s.uX)(),(0,s.CE)("div",{key:1,style:(0,i.Tr)(l.hoverHandStyle),class:"hand-tooltip-debug"},[(0,s.bF)(B,{hand:l.players[l.hoverHandIdx].hand,selectedIndexes:[],getSuitClass:a.getSuitClass},null,8,["hand","getSuitClass"])],4)):(0,s.Q3)("",!0)])}n(1201),n(6040),n(2144),n(9062),n(198);const B=["♠","♥","♣","♦"],j=["4","6","7","8","9","10","J","Q","K","A","2","3","5"];function W(){const e=[];for(const t of B)for(const n of j)e.push({suit:t,value:n});return e}function Q(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}function q(e){const t=[[],[],[],[]];for(let n=0;n<e.length;n++)t[n%4].push(e[n]);for(let n=0;n<4;n++)t[n].sort((e,t)=>j.indexOf(e.value)-j.indexOf(t.value));return t}n(3047),n(5129),n(8773),n(2695),n(5777),n(5708),n(5633),n(922),n(5889),n(637);function M(e,t){return j.indexOf(e.value)-j.indexOf(t.value)}function R(e,t){if(!e||0===e.length)return!1;const n=J(e);if("invalid"===n)return!1;if(!t||0===t.length)return!0;const r=J(t);if("bomb"===n&&"bomb"!==r)return!0;if("triple"===n&&"bomb"!==r&&"triple"!==r)return!0;if(n!==r)return!1;if(e.length!==t.length)return!1;const s=V(e),l=V(t);return M(s[0],l[0])>0}function V(e){return e.slice().sort(M)}function J(e){return 2===e.length&&e[0].value===e[1].value?"pair":3===e.length&&e[0].value===e[1].value&&e[1].value===e[2].value?"triple":4===e.length&&e[0].value===e[1].value&&e[1].value===e[2].value&&e[2].value===e[3].value?"bomb":N(e)?"straight":z(e)?"doubleStraight":1===e.length?"single":"invalid"}function N(e){if(e.length<3)return!1;const t=e.map(e=>j.indexOf(e.value)).sort((e,t)=>e-t);for(let n=1;n<t.length;n++){if("K"===j[t[n-1]]&&"A"!==j[t[n]])return!1;if(("K"!==j[t[n-1]]||"A"!==j[t[n]])&&t[n]-t[n-1]!==1)return!1}return!0}function z(e){if(e.length<4||e.length%2!==0)return!1;const t=e.slice().sort(M);for(let n=0;n<t.length;n+=2){if(t[n].value!==t[n+1].value)return!1;if(n>0){const e=j.indexOf(t[n].value),r=j.indexOf(t[n-2].value);if("K"===j[r]&&"A"!==j[e])return!1;if(("K"!==j[r]||"A"!==j[e])&&e-r!==1)return!1}}return!0}function D(e,t=[]){const n=[];for(const r of e)r.cards&&r.cards.length&&n.push(...r.cards);return t&&t.length&&n.push(...t),n}function U(e,t){const n=j,r=[];for(const a of B)for(const e of n)r.push({suit:a,value:e});const s=D(t,e),l=new Set(s.map(e=>`${e.suit}${e.value}`));return r.filter(e=>!l.has(`${e.suit}${e.value}`))}function Y(e){return e&&0!==e.length?e.slice().sort((e,t)=>j.indexOf(e[0].value)-j.indexOf(t[0].value))[0]:null}function Z(e){return e&&0!==e.length?e.slice().sort((e,t)=>j.indexOf(e[0].value)-j.indexOf(t[0].value))[0]:null}function ee(e){return e&&0!==e.length?e.slice().sort((e,t)=>e.length-t.length||j.indexOf(e[0].value)-j.indexOf(t[0].value))[0]:null}function te(e,t=[],n,r=[],s=0,l=[]){let a="normal";const i=n%4+1;if(!e||0===e.length)return[];const u=V(e),o=Ce(s,r,l),c=be(s,r.length||4),h=r&&r[c]?r[c].hand.length:99,d=(s+r.length-1)%r.length,f=r&&r[d]?r[d]:null,v=o.includes(d),g=f?f.hand.length:99;o.some(e=>r[e].hand.length<=2)?a="team":e.length<=5||h<=2?a="aggressive":i<=3&&(a="conservative");const p=U(e,l),y=["2","A","5","3"],m={2:0,A:0,5:0,3:0,bomb:0,triple:0};for(const _ of p)y.includes(_.value)&&m[_.value]++;const k={};for(const _ of p)k[_.value]=(k[_.value]||0)+1;for(const _ in k)k[_]>=4?m.bomb++:k[_]>=3&&m.triple++;const C=ie(u,i,e.length),b=C.filter(e=>3===e.length&&re(e)),x=C.filter(e=>4===e.length&&ne(e)),L=C.filter(e=>e.length>=3&&pe(e)),A=C.filter(e=>e.length>=4&&ye(e)),I=C.filter(e=>2===e.length&&se(e)),$=C.filter(e=>1===e.length);let E=!1,S=null;if(l&&l.length){for(let e=l.length-1;e>=0;e--){const t=l[e];if(t&&t.cards&&t.cards.length){S=t;break}}if(S){const e=e=>!!S&&("number"===typeof S.playerIndex?S.playerIndex===e:!!(S.name&&r&&r[e])&&S.name===r[e].name);if(e(s)){let e=!1;for(let t=l.indexOf(S)+1;t<l.length;t++){const n=l[t];if(n&&n.cards&&n.cards.length){e=!0;break}}e||(E=!0)}}}let P=L,w=A,O=I,T=$,X=b;if(E&&S&&S.cards){const e=S.cards,t=t=>t.filter(t=>!R(t,e));P=t(L),w=t(A),O=t(I),T=t($),X=t(b)}if("team"===a){if(t&&t.length>0&&v&&g<=2)return[];if(E&&(!t||0===t.length)){const e=Y($);if(e)return e;const t=Z(I);if(t)return t;const n=ee(L);if(n)return n;const r=ee(A);if(r)return r}const e=(E?T:$).filter(e=>!["2","A"].includes(e[0].value));if(e.length>0)return e[0];const n=(E?O:I).filter(e=>!["2","A"].includes(e[0].value));if(n.length>0)return n[0];const r=(E?P:L).filter(e=>e.every(e=>!["2","A"].includes(e.value)));if(r.length>0)return r[0];const s=(E?w:A).filter(e=>e.every(e=>!["2","A"].includes(e.value)));if(s.length>0)return s[0];const l=(E?X:b).filter(e=>!["2","A"].includes(e[0].value));return l.length>0?l[0]:x.length>0?x[0]:[u[0]]}if("aggressive"===a){if(t&&t.length>0){for(let e=C.length-1;e>=0;e--)if(R(C[e],t))return C[e];return[]}if(E&&(!t||0===t.length)){const e=Y($);if(e)return e;const t=Z(I);if(t)return t;const n=ee(L);if(n)return n;const r=ee(A);if(r)return r}const e=(E?P:L).filter(e=>e.every(e=>!["2","A"].includes(e.value)));if(e.length>0)return e[0];const n=(E?w:A).filter(e=>e.every(e=>!["2","A"].includes(e.value)));if(n.length>0)return n[0];const r=(E?X:b).filter(e=>!["2","A"].includes(e[0].value));if(r.length>0)return r[0];const s=(E?O:I).filter(e=>!["2","A"].includes(e[0].value));if(s.length>0)return s[0];const l=(E?T:$).filter(e=>!["2","A"].includes(e[0].value));return l.length>0?l[0]:x.length>0?x[0]:[u[0]]}if(t&&t.length>0){for(const e of x)if(R(e,t))return e;if(re(t)){if(i<=3){for(const e of x)if(R(e,t))return e;return[]}for(const e of b)if(R(e,t))return e;for(const e of x)if(R(e,t))return e;return[]}if((me(t)||ke(t))&&i<=3){for(const e of b)if(R(e,t))return e;for(const e of x)if(R(e,t))return e}if(pe(t)){for(const e of E?P:L)if(R(e,t))return e;for(const e of x)if(R(e,t))return e;return[]}if(ye(t)){for(const e of E?w:A)if(R(e,t))return e;for(const e of x)if(R(e,t))return e;return[]}for(const e of C)if(!ne(e)&&!re(e)&&R(e,t)&&!le(e,u,C)&&(1===e.length||2===e.length))return e;for(const e of C)if(!ne(e)&&R(e,t)&&!le(e,u,C))return e;for(const e of C)if(R(e,t))return e;return[]}if("conservative"===a||"normal"===a){if(t&&t.length>0){for(const e of C)if(R(e,t))return e;return[]}if(e.length>5){if(E&&(!t||0===t.length)){const e=Y($);if(e)return e;const t=Z(I);if(t)return t;const n=ee(L);if(n)return n;const r=ee(A);if(r)return r}if(m["2"]>0&&$.length>0){const e=$.find(e=>"2"!==e[0].value);if(e)return e}if(m["A"]>0&&$.length>0){const e=$.find(e=>"A"!==e[0].value);if(e)return e}if(m.bomb>0&&x.length>0){const e=$.length>0?$[0]:null;if(e)return e}return I.length>0?I[0]:L.length>0?L[0]:A.length>0?A[0]:$.length>0?$[0]:b.length>0?b[0]:x.length>0?x[0]:[u[0]]}return $.length>0?$[0]:I.length>0?I[0]:b.length>0?b[0]:L.length>0?L[0]:A.length>0?A[0]:x.length>0?x[0]:[u[0]]}}function ne(e){return 4===e.length&&e.every(t=>t.value===e[0].value)}function re(e){return 3===e.length&&e.every(t=>t.value===e[0].value)}function se(e){return 2===e.length&&e[0].value===e[1].value}function le(e,t,n){for(const r of n)if(r.some(t=>e.includes(t))&&!ae(r,e))return!0;return!1}function ae(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function ie(e,t,n){const r=[],s=new Set,l=fe(e,s);l.forEach(e=>e.forEach(e=>s.add(`${e.suit}${e.value}`)));const a=de(e,s);a.forEach(e=>e.forEach(e=>s.add(`${e.suit}${e.value}`)));const i=ue(e,s);i.forEach(e=>e.forEach(e=>s.add(`${e.suit}${e.value}`)));const u=oe(e,s);u.forEach(e=>e.forEach(e=>s.add(`${e.suit}${e.value}`)));const o=ce(e,s);o.forEach(e=>e.forEach(e=>s.add(`${e.suit}${e.value}`)));const c=he(e,s);return c.forEach(e=>e.forEach(e=>s.add(`${e.suit}${e.value}`))),r.push(...i,...u,...o,...c),(t>3||n<=5)&&r.push(...a,...l),r}function ue(e,t){const n=[];for(let r=3;r<=e.length;r++)for(let s=0;s<=e.length-r;s++){const l=e.slice(s,s+r);!pe(l)||ve(l)||ge(l,t)||(n.push(l),l.forEach(e=>t.add(`${e.suit}${e.value}`)))}return n}function oe(e,t){const n=[];for(let r=4;r<=e.length;r+=2)for(let s=0;s<=e.length-r;s++){const l=e.slice(s,s+r);!ye(l)||ve(l)||ge(l,t)||(n.push(l),l.forEach(e=>t.add(`${e.suit}${e.value}`)))}return n}function ce(e,t){const n=[];for(let r=0;r<e.length-1;r++)e[r].value!==e[r+1].value||ge([e[r],e[r+1]],t)||(n.push([e[r],e[r+1]]),t.add(`${e[r].suit}${e[r].value}`),t.add(`${e[r+1].suit}${e[r+1].value}`));return n}function he(e,t){const n=[];for(const r of e)ge([r],t)||(n.push([r]),t.add(`${r.suit}${r.value}`));return n}function de(e,t){const n=[];for(let r=0;r<e.length-2;r++)e[r].value!==e[r+1].value||e[r].value!==e[r+2].value||ge([e[r],e[r+1],e[r+2]],t)||(n.push([e[r],e[r+1],e[r+2]]),t.add(`${e[r].suit}${e[r].value}`),t.add(`${e[r+1].suit}${e[r+1].value}`),t.add(`${e[r+2].suit}${e[r+2].value}`));return n}function fe(e,t){const n=[];for(let r=0;r<e.length-3;r++)e[r].value!==e[r+1].value||e[r].value!==e[r+2].value||e[r].value!==e[r+3].value||ge([e[r],e[r+1],e[r+2],e[r+3]],t)||(n.push([e[r],e[r+1],e[r+2],e[r+3]]),t.add(`${e[r].suit}${e[r].value}`),t.add(`${e[r+1].suit}${e[r+1].value}`),t.add(`${e[r+2].suit}${e[r+2].value}`),t.add(`${e[r+3].suit}${e[r+3].value}`));return n}function ve(e){const t=new Set;for(const n of e){if(t.has(n.suit))return!0;t.add(n.suit)}return!1}function ge(e,t){for(const n of e)if(t.has(`${n.suit}${n.value}`))return!0;return!1}function pe(e){if(e.length<3)return!1;for(let t=1;t<e.length;t++){if("K"===e[t-1].value&&"A"!==e[t].value)return!1;if(("K"!==e[t-1].value||"A"!==e[t].value)&&e[t].value.charCodeAt(0)-e[t-1].value.charCodeAt(0)!==1)return!1;if(e[t].value===e[t-1].value)return!1}return!0}function ye(e){if(e.length<4||e.length%2!==0)return!1;for(let t=0;t<e.length;t+=2){if(e[t].value!==e[t+1].value)return!1;if(t>0){if("K"===e[t-2].value&&"A"!==e[t].value)return!1;if(("K"!==e[t-2].value||"A"!==e[t].value)&&e[t].value.charCodeAt(0)-e[t-2].value.charCodeAt(0)!==1)return!1}}return!0}function me(e){return pe(e)&&e.length>=5}function ke(e){return ye(e)&&e.length>=6}function Ce(e,t,n){let r=null;for(let s=0;s<t.length;s++)if(t[s].hand.some(e=>"♠"===e.suit&&"5"===e.value)){r=s;break}if(null===r&&n&&n.length)for(const s of n)if(s.cards&&s.cards.some(e=>"♠"===e.suit&&"5"===e.value)){r=t.findIndex(e=>e.name===s.name);break}if(null!==r){const n=t.map((e,t)=>t).filter(n=>(t[n].isBanker||n===r)&&n!==e);return n}return[]}function be(e,t){return(e+1)%t}const xe={class:"hand-outer"},Le=["onClick"],Ae={class:"card-corner top-left"},Ie={class:"card-corner bottom-right"};function $e(e,t,n,r,l,a){return(0,s.uX)(),(0,s.CE)("div",xe,[(0,s.Lk)("div",{class:"hand",ref:"myHand",style:(0,i.Tr)({width:a.handWidth+"px"})},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.hand,(e,t)=>((0,s.uX)(),(0,s.CE)("span",{key:t,class:(0,i.C4)([{selected:n.selectedIndexes.includes(t)},n.getSuitClass(e.suit),"card-item"]),onClick:e=>a.toggleSelect(t),style:(0,i.Tr)({left:22*t+"px",zIndex:t})},[(0,s.Lk)("span",Ae,[(0,s.Lk)("span",{class:(0,i.C4)(["corner-value",n.getSuitClass(e.suit)])},(0,i.v_)(e.value),3),(0,s.Lk)("span",{class:(0,i.C4)(["corner-suit",n.getSuitClass(e.suit)])},(0,i.v_)(e.suit),3)]),(0,s.Lk)("span",Ie,[(0,s.Lk)("span",{class:(0,i.C4)(["corner-value",n.getSuitClass(e.suit)])},(0,i.v_)(e.value),3),(0,s.Lk)("span",{class:(0,i.C4)(["corner-suit",n.getSuitClass(e.suit)])},(0,i.v_)(e.suit),3)])],14,Le))),128))],4)])}var Ee={name:"CardHand",props:{hand:Array,selectedIndexes:Array,getSuitClass:Function},emits:["toggleSelect"],computed:{handWidth(){return this.hand&&0!==this.hand.length?1===this.hand.length?44:44+22*(this.hand.length-1):0}},methods:{toggleSelect(e){this.$emit("toggleSelect",e)}}},Se=n(7017);const Pe=(0,Se.A)(Ee,[["render",$e],["__scopeId","data-v-65454eae"]]);var we=Pe;const Oe={class:"recorder"},Te={class:"recorder-cards"},Xe={class:"recorder-row"},_e={class:"recorder-row"};function He(e,t,n,r,l,a){return(0,s.uX)(),(0,s.CE)("div",Oe,[t[0]||(t[0]=(0,s.Lk)("div",{class:"recorder-title"},"记牌器",-1)),(0,s.Lk)("div",Te,[(0,s.Lk)("div",Xe,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.cardOrder,e=>((0,s.uX)(),(0,s.CE)("span",{key:e,class:"recorder-num"},(0,i.v_)(e),1))),128))]),(0,s.Lk)("div",_e,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.cardOrder,e=>((0,s.uX)(),(0,s.CE)("span",{key:e,class:"recorder-count"},(0,i.v_)(a.getCardLeftCount(n.players,e)),1))),128))])])])}const Ke=["4","6","7","8","9","10","J","Q","K","A","2","3","5"];function Fe(e,t){let n=0;for(let r=1;r<e.length;r++)n+=e[r].hand.filter(e=>e.value===t).length;return n}var Ge={name:"Recorder",props:{players:Array,cardOrder:{type:Array,default:()=>Ke}},methods:{getCardLeftCount:Fe}};const Be=(0,Se.A)(Ge,[["render",He],["__scopeId","data-v-40ea67fe"]]);var je=Be,We={name:"GameTable",components:{CardHand:we,Recorder:je},created(){this.players=[{name:"自己",isAI:!1,isBanker:!0,team:0,hand:[]},{name:"AI1",isAI:!0,isBanker:!1,team:1,hand:[]},{name:"AI2",isAI:!0,isBanker:!1,team:1,hand:[]},{name:"AI3",isAI:!0,isBanker:!1,team:1,hand:[]}]},data(){return{players:[],cardOrder:["4","6","7","8","9","10","J","Q","K","A","2","3","5"],currentTurn:0,playNumber:0,currentPlay:[],winner:null,selectedIndexes:[],historyPlays:[],hoverHandIdx:null,hoverHandStyle:{}}},watch:{historyPlays:{handler(){this.$nextTick(()=>{const e=this.$refs.historyList;e&&requestAnimationFrame(()=>{e.scrollTop=e.scrollHeight,requestAnimationFrame(()=>{e.scrollTop=e.scrollHeight})})})},deep:!0}},computed:{canPlay(){return this.players[this.currentTurn].isAI||null!==this.winner||0===this.selectedIndexes.length},canPass(){const e=this.getLastValidPlay();return this.players[this.currentTurn].isAI||null!==this.winner||0===this.historyPlays.length||e.name===this.players[this.currentTurn].name}},methods:{startGame(){const e=Q(W()),t=q(e);for(let n=0;n<4;n++)this.players[n].hand=t[n],this.hasBlackFive(this.players[n]);this.currentTurn=0,this.currentPlay=[],this.historyPlays=[],this.winner=null,this.selectedIndexes=[]},getLastValidPlay(){for(let e=this.historyPlays.length-1;e>=0;e--)if(this.historyPlays[e].cards&&this.historyPlays[e].cards.length>0)return this.historyPlays[e];return null},hasBlackFive(e){for(let t=0;t<e.hand.length;t++)if("♥"===e.hand[t].suit&&"5"===e.hand[t].value)return void(e.team=0)},playCards(){const e=this.players[this.currentTurn];if(0===this.selectedIndexes.length)return;const t=this.selectedIndexes.slice().sort((e,t)=>e-t),n=t.map(t=>e.hand[t]),r=this.getLastValidPlay();let s=[];if(r&&r.name!==e.name&&(s=r.cards),R(n,s)){this.currentPlay=n,this.historyPlays.push({name:e.name,cards:n.map(e=>({...e}))});for(let n=t.length-1;n>=0;n--)e.hand.splice(t[n],1);this.selectedIndexes=[],this.checkWinner(),this.nextTurn()}else alert("手牌小")},getSuitClass(e){return"♥"===e||"♦"===e?"red-suit":"♠"===e||"♣"===e?"black-suit":""},toggleSelect(e){if(0!==this.currentTurn||null!==this.winner)return;const t=this.selectedIndexes.indexOf(e);this.selectedIndexes=-1===t?[...this.selectedIndexes,e]:this.selectedIndexes.filter(t=>t!==e)},pass(){0===this.historyPlays.length&&alert("第一次不允许不出");const e=this.players[this.currentTurn];this.historyPlays.push({name:e.name,cards:[]}),this.currentPlay=[],this.nextTurn()},nextTurn(){if(null!==this.winner)return;this.currentTurn=(this.currentTurn+1)%4,this.playNumber++;const e=this.players[this.currentTurn];e.isAI&&this.aiPlay()},aiPlay(){const e=this.players[this.currentTurn];e.hand.length>0?setTimeout(()=>{const t=this.getLastValidPlay();let n=[];t&&t.name!==e.name&&(n=t.cards);const r=te(e.hand,n,this.playNumber,this.players,this.currentTurn,this.historyPlays);r&&r.length>0?(this.currentPlay=r,this.historyPlays.push({name:e.name,cards:r.map(e=>({...e}))}),e.hand=e.hand.filter(e=>!r.some(t=>t.suit===e.suit&&t.value===e.value))):(this.historyPlays.push({name:e.name,cards:[]}),this.currentPlay=[]),this.checkWinner(),this.nextTurn()},700+800*Math.random()):(this.currentPlay=[],this.checkWinner(),this.nextTurn())},checkWinner(){for(let e=0;e<4;e++)0===this.players[e].hand.length&&(this.winner=e)},toggleHand(e){this.hoverHandIdx===e?this.hideHand():this.showHand(e)},showHand(e){this.hoverHandIdx=e,this.hoverHandStyle={position:"fixed",left:"50%",top:"21%",transform:"translate(-50%, -50%)",zIndex:1e3,background:"#fff",border:"1px solid #ccc",padding:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",borderRadius:"4px",minWidth:"180px",minHeight:"100px"}},hideHand(){this.hoverHandIdx=null},handleBodyClick(e){if(null!==this.hoverHandIdx){const t=this.$el.querySelector(".hand-tooltip-debug"),n=this.$el.querySelectorAll(".player-tab");if(t&&t.contains(e.target)||Array.from(n).some(t=>t.contains(e.target)))return;this.hideHand()}}},mounted(){this.startGame(),document.body.addEventListener("click",this.handleBodyClick,!0)},beforeUnmount(){document.body.removeEventListener("click",this.handleBodyClick,!0)}};const Qe=(0,Se.A)(We,[["render",G],["__scopeId","data-v-4535a77b"]]);var qe=Qe,Me={name:"App",components:{GameTable:qe},data(){return{showGame:!1}}};const Re=(0,Se.A)(Me,[["render",a]]);var Ve=Re;(0,r.Ef)(Ve).mount("#app"),"undefined"!==typeof window&&document.addEventListener("dblclick",function(e){e.preventDefault()},{passive:!1})}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var l=t[r]={exports:{}};return e[r].call(l.exports,l,l.exports,n),l.exports}n.m=e,function(){var e=[];n.O=function(t,r,s,l){if(!r){var a=1/0;for(c=0;c<e.length;c++){r=e[c][0],s=e[c][1],l=e[c][2];for(var i=!0,u=0;u<r.length;u++)(!1&l||a>=l)&&Object.keys(n.O).every(function(e){return n.O[e](r[u])})?r.splice(u--,1):(i=!1,l<a&&(a=l));if(i){e.splice(c--,1);var o=s();void 0!==o&&(t=o)}}return t}l=l||0;for(var c=e.length;c>0&&e[c-1][2]>l;c--)e[c]=e[c-1];e[c]=[r,s,l]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,r){var s,l,a=r[0],i=r[1],u=r[2],o=0;if(a.some(function(t){return 0!==e[t]})){for(s in i)n.o(i,s)&&(n.m[s]=i[s]);if(u)var c=u(n)}for(t&&t(r);o<a.length;o++)l=a[o],n.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return n.O(c)},r=self["webpackChunkjihei5"]=self["webpackChunkjihei5"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=n.O(void 0,[504],function(){return n(918)});r=n.O(r)})();
//# sourceMappingURL=app.2dc63052.js.map